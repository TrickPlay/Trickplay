--- a/clutter/eglnative/clutter-stage-egl.c	2009-10-19 07:32:54.000000000 -0700
+++ b/clutter/eglnative/clutter-stage-egl.c	2010-10-22 16:03:36.977642101 -0700
@@ -18,6 +18,8 @@
 #include "../clutter-stage.h"
 #include "../clutter-stage-window.h"
 
+extern NativeWindowType tp_egl_get_native_window();
+
 static void clutter_stage_window_iface_init (ClutterStageWindowIface *iface);
 
 G_DEFINE_TYPE_WITH_CODE (ClutterStageEGL,
@@ -26,6 +28,28 @@
                          G_IMPLEMENT_INTERFACE (CLUTTER_TYPE_STAGE_WINDOW,
                                                 clutter_stage_window_iface_init));
 
+
+static void
+clutter_stage_egl_window_show(ClutterStageWindow *stage_window,
+                              gboolean            do_raise)
+{
+  ClutterStageEGL *stage_egl = CLUTTER_STAGE_EGL (stage_window);
+
+  clutter_actor_map (CLUTTER_ACTOR (stage_egl));
+  clutter_actor_map (CLUTTER_ACTOR (stage_egl->wrapper));
+  
+}
+
+static void
+clutter_stage_egl_window_hide(ClutterStageWindow *stage_window)
+{
+  ClutterStageEGL *stage_egl = CLUTTER_STAGE_EGL (stage_window);
+
+  clutter_actor_unmap (CLUTTER_ACTOR (stage_egl));
+  clutter_actor_unmap (CLUTTER_ACTOR (stage_egl->wrapper));  
+}
+
+
 static void
 clutter_stage_egl_show (ClutterActor *actor)
 {
@@ -130,10 +154,12 @@
             backend_egl->egl_context = NULL;
          }
 
+      CLUTTER_NOTE(BACKEND, "About to create window surface: %i",backend_egl->edpy);
+
       stage_egl->egl_surface =
 	eglCreateWindowSurface (backend_egl->edpy,
                                 configs[0],
-                                NULL,
+                                tp_egl_get_native_window(),
                                 NULL);
 
       if (stage_egl->egl_surface == EGL_NO_SURFACE)
@@ -227,10 +253,10 @@
   ClutterStageEGL *stage_egl = CLUTTER_STAGE_EGL (self);
 
   if (min_width_p)
-    *min_width_p = CLUTTER_UNITS_FROM_DEVICE (stage_egl->surface_width);
+    *min_width_p = stage_egl->surface_width;
 
   if (natural_width_p)
-    *natural_width_p = CLUTTER_UNITS_FROM_DEVICE (stage_egl->surface_width);
+    *natural_width_p = stage_egl->surface_width;
 }
 
 static void
@@ -242,10 +268,10 @@
   ClutterStageEGL *stage_egl = CLUTTER_STAGE_EGL (self);
 
   if (min_height_p)
-    *min_height_p = CLUTTER_UNITS_FROM_DEVICE (stage_egl->surface_height);
+    *min_height_p = stage_egl->surface_height;
 
   if (natural_height_p)
-    *natural_height_p = CLUTTER_UNITS_FROM_DEVICE (stage_egl->surface_height);
+    *natural_height_p = stage_egl->surface_height;
 }
 
 static void
@@ -292,6 +318,8 @@
   iface->set_fullscreen = clutter_stage_egl_set_fullscreen;
   iface->set_title = NULL;
   iface->get_wrapper = clutter_stage_egl_get_wrapper;
+  iface->show=clutter_stage_egl_window_show;
+  iface->hide=clutter_stage_egl_window_hide;
 }
 
 static void
